#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	./shc -rT -f pl3.sh 
#endif

static  char data [] = 
#define      tst1_z	22
#define      tst1	((&data[1]))
	"\160\172\145\207\355\256\364\312\053\052\122\364\240\027\357\010"
	"\274\207\324\252\375\170\143"
#define      rlax_z	1
#define      rlax	((&data[23]))
	"\111"
#define      msg1_z	42
#define      msg1	((&data[30]))
	"\146\001\127\266\221\103\102\020\200\134\244\075\331\351\000\110"
	"\007\112\160\235\036\216\307\314\177\355\031\137\213\160\167\142"
	"\121\360\132\212\343\163\206\007\047\064\116\262\346\244\320\230"
	"\301\271\354"
#define      chk1_z	22
#define      chk1	((&data[77]))
	"\060\121\322\202\026\311\356\004\064\275\321\122\033\163\270\015"
	"\206\350\376\213\135\206\023\201\046\300\161\153"
#define      lsto_z	1
#define      lsto	((&data[103]))
	"\070"
#define      tst2_z	19
#define      tst2	((&data[105]))
	"\133\153\355\205\112\006\124\034\374\340\310\234\334\110\334\117"
	"\142\313\043\334\001"
#define      date_z	1
#define      date	((&data[125]))
	"\316"
#define      opts_z	1
#define      opts	((&data[126]))
	"\130"
#define      text_z	3159
#define      text	((&data[415]))
	"\115\241\364\007\216\215\173\117\276\315\166\177\076\341\355\075"
	"\053\330\204\217\063\206\277\340\234\172\346\030\067\103\113\205"
	"\344\077\214\162\315\010\302\214\326\070\013\025\032\371\123\105"
	"\321\327\325\005\135\224\345\371\017\313\022\107\017\135\314\363"
	"\235\131\146\153\142\050\367\070\141\003\115\173\374\240\301\315"
	"\170\226\322\326\053\270\320\072\203\342\201\223\100\116\206\336"
	"\250\355\111\012\026\100\103\170\103\221\364\100\062\265\015\253"
	"\114\340\201\167\230\122\261\034\064\063\257\165\202\066\123\052"
	"\044\234\065\072\335\171\263\041\012\247\141\075\134\157\350\250"
	"\120\152\037\351\274\321\005\360\005\265\146\207\353\271\262\017"
	"\125\347\112\063\141\375\124\154\245\266\251\001\045\221\252\166"
	"\373\311\137\267\233\144\250\240\032\016\050\005\307\332\025\035"
	"\302\140\120\043\136\245\217\003\133\070\005\201\312\257\367\305"
	"\171\126\175\024\273\045\265\325\064\335\333\374\267\361\032\171"
	"\121\153\235\260\020\054\263\154\145\270\355\057\150\345\365\341"
	"\074\162\365\367\230\252\315\314\207\251\311\077\232\343\270\353"
	"\116\125\233\136\202\117\312\347\010\270\027\160\235\014\121\331"
	"\176\107\321\027\361\237\343\171\110\255\270\342\220\161\316\336"
	"\264\110\200\025\120\111\263\243\216\200\111\174\135\265\354\261"
	"\260\037\201\133\274\324\132\035\151\231\220\334\067\227\235\045"
	"\050\205\217\212\161\161\025\143\047\335\161\334\256\266\233\255"
	"\310\355\266\001\363\312\325\110\143\034\142\017\123\177\277\205"
	"\112\172\063\351\212\246\342\104\163\133\032\351\117\143\273\126"
	"\147\307\016\117\212\034\231\170\017\203\134\200\214\266\262\140"
	"\342\072\030\146\155\000\167\345\334\303\300\121\012\044\373\205"
	"\255\235\263\011\171\275\330\371\030\133\350\126\277\212\316\244"
	"\056\017\003\044\023\052\212\307\205\352\140\366\023\230\325\217"
	"\160\206\351\205\367\131\246\243\055\117\344\320\170\164\257\157"
	"\312\004\071\134\240\316\116\231\152\127\335\022\032\366\220\072"
	"\035\362\136\224\015\065\053\305\315\206\040\203\123\077\107\362"
	"\065\317\045\003\073\141\067\070\102\056\317\173\070\205\112\114"
	"\265\100\311\234\034\227\022\156\176\075\102\103\243\063\326\143"
	"\165\020\220\317\256\326\363\236\137\001\334\243\146\143\233\134"
	"\043\001\313\307\345\000\031\162\220\101\205\315\022\213\320\046"
	"\237\252\133\147\345\313\273\026\362\271\065\260\365\054\055\363"
	"\360\037\316\101\025\340\070\253\013\266\033\056\271\364\311\177"
	"\206\210\231\022\237\023\363\025\340\354\003\215\232\112\351\352"
	"\320\221\133\331\356\275\350\173\162\042\337\331\107\004\115\236"
	"\306\127\173\164\074\344\177\035\276\352\037\353\167\127\162\174"
	"\002\231\165\031\114\055\136\020\165\237\024\346\073\120\045\110"
	"\011\143\165\155\154\354\377\376\052\320\110\172\135\231\171\257"
	"\134\276\347\225\315\243\330\202\020\251\246\167\172\170\061\000"
	"\211\137\346\112\046\077\004\051\106\122\242\010\237\273\106\317"
	"\332\212\332\346\072\377\234\376\023\137\050\030\011\243\352\244"
	"\203\373\225\132\371\004\147\065\011\161\363\060\316\305\013\143"
	"\065\325\303\025\245\111\141\107\140\010\315\120\066\217\050\351"
	"\232\213\210\132\362\171\167\045\351\354\111\046\200\101\332\360"
	"\004\157\177\212\360\337\243\323\044\032\032\133\207\035\233\023"
	"\361\265\237\316\006\035\333\301\126\356\322\141\044\004\266\121"
	"\301\050\152\063\074\264\372\255\354\174\002\150\015\231\350\113"
	"\065\315\205\120\125\026\105\356\106\031\342\262\212\264\236\241"
	"\232\051\243\013\240\176\264\373\240\065\123\056\334\170\241\333"
	"\374\266\364\363\120\021\374\260\323\025\003\066\374\266\227\224"
	"\010\310\305\216\207\055\177\143\276\366\234\064\371\035\122\245"
	"\142\100\234\120\323\165\141\161\135\344\206\161\031\062\043\246"
	"\365\351\110\121\207\266\075\123\103\221\361\016\243\364\046\122"
	"\303\153\133\002\213\274\002\320\255\166\133\344\070\046\074\166"
	"\345\204\223\304\032\330\373\130\251\226\255\062\235\275\066\170"
	"\152\215\111\354\101\337\241\374\313\373\275\303\107\314\032\334"
	"\245\100\245\132\101\010\363\300\053\232\376\045\054\101\227\017"
	"\132\175\027\123\174\345\202\163\136\102\346\046\115\270\153\054"
	"\372\235\322\251\256\316\362\350\233\041\271\243\141\045\120\045"
	"\045\036\247\310\326\041\200\271\372\117\237\220\372\355\213\012"
	"\027\227\252\236\006\212\063\243\374\253\010\110\231\276\232\272"
	"\162\074\363\271\324\031\226\017\055\107\134\002\257\370\031\030"
	"\026\336\265\356\041\055\043\074\245\154\044\242\170\306\007\067"
	"\310\362\113\257\045\376\213\345\371\247\341\227\225\305\022\251"
	"\043\355\000\053\052\122\326\022\031\043\371\365\037\073\037\021"
	"\234\360\361\275\226\142\006\307\125\205\320\353\351\347\215\153"
	"\063\130\104\271\127\146\310\341\245\163\307\154\233\315\344\203"
	"\320\035\236\175\022\147\115\311\244\030\041\147\134\024\256\027"
	"\145\317\334\311\313\262\251\372\326\367\177\202\210\242\301\270"
	"\252\103\077\126\320\114\033\016\140\342\312\377\247\123\164\245"
	"\121\227\155\022\351\220\304\160\355\045\052\165\171\047\122\233"
	"\245\140\171\235\066\317\042\246\153\065\247\245\006\040\342\102"
	"\136\047\133\123\140\245\171\376\342\276\204\303\017\014\371\024"
	"\327\125\371\023\322\267\163\062\341\253\022\164\270\377\263\035"
	"\360\376\102\122\324\167\177\246\366\157\234\213\126\123\034\277"
	"\133\247\011\325\373\067\276\175\111\131\062\222\010\375\202\270"
	"\232\227\067\242\175\242\375\072\272\162\101\273\034\272\053\000"
	"\202\034\201\031\054\045\106\073\133\145\064\026\105\070\345\376"
	"\311\056\332\373\174\265\146\106\021\342\010\336\066\263\131\356"
	"\111\326\330\106\177\275\341\340\150\023\223\064\057\050\167\316"
	"\052\164\214\043\341\045\023\266\024\232\372\107\025\246\151\074"
	"\305\260\111\204\352\174\362\120\074\172\150\344\052\077\312\173"
	"\053\272\154\276\134\355\204\367\173\154\120\036\360\334\062\106"
	"\013\205\342\122\145\156\370\221\351\115\265\255\176\357\044\155"
	"\067\141\037\306\116\136\331\274\007\170\127\007\104\353\011\345"
	"\122\241\346\032\100\372\227\202\303\355\006\072\011\360\067\271"
	"\071\131\342\311\126\213\241\357\153\330\030\240\250\306\006\220"
	"\322\204\054\140\236\172\114\115\353\345\152\277\037\037\073\153"
	"\355\047\077\317\104\353\202\140\227\016\060\163\343\146\162\077"
	"\204\347\002\214\073\271\313\034\246\121\216\167\321\253\166\023"
	"\300\205\202\075\303\100\250\123\004\104\016\162\124\064\077\314"
	"\326\023\353\246\151\056\045\257\100\200\043\327\342\041\045\037"
	"\347\230\355\110\015\036\214\164\034\242\172\341\075\336\161\075"
	"\213\331\145\261\233\227\370\316\363\123\112\043\264\033\147\036"
	"\364\155\014\076\147\304\044\033\162\054\054\121\264\134\261\210"
	"\265\330\055\142\235\234\066\050\115\125\367\236\312\351\120\116"
	"\223\072\112\150\151\205\311\274\152\320\002\074\227\276\325\013"
	"\041\355\006\033\064\166\070\041\217\036\326\141\366\125\172\202"
	"\172\166\071\067\222\264\057\105\015\032\115\046\226\223\241\300"
	"\123\025\364\274\342\266\322\342\372\316\310\050\277\217\040\025"
	"\255\147\074\165\171\313\222\312\210\204\054\231\066\105\222\302"
	"\133\215\276\231\124\355\161\267\266\376\233\365\321\223\121\036"
	"\043\232\260\323\113\305\373\277\016\134\263\000\323\232\044\124"
	"\217\132\127\364\301\253\340\275\015\305\345\337\333\312\340\013"
	"\332\307\054\336\226\122\346\175\122\111\012\041\272\024\106\135"
	"\145\223\315\045\357\275\102\246\022\335\201\002\272\150\227\072"
	"\145\310\075\352\014\263\020\303\125\330\120\137\306\203\150\367"
	"\100\224\064\253\332\237\044\177\312\312\162\225\011\377\012\000"
	"\015\361\356\220\047\166\143\123\047\103\273\366\361\060\157\252"
	"\100\150\047\270\332\211\146\250\345\212\155\127\243\340\105\016"
	"\124\125\066\052\232\026\374\321\070\355\355\216\230\026\324\112"
	"\246\264\171\114\037\016\233\344\264\070\255\161\031\327\016\031"
	"\102\170\050\261\253\260\220\005\016\062\270\021\220\224\321\065"
	"\251\250\317\151\304\121\264\014\015\030\360\053\264\113\073\216"
	"\146\064\050\152\167\276\262\065\205\100\157\161\127\334\355\117"
	"\367\321\055\247\213\313\113\305\361\140\231\207\072\012\254\250"
	"\251\336\230\146\027\155\140\301\246\113\337\166\001\116\232\150"
	"\133\267\001\113\103\104\204\342\174\236\175\231\034\215\264\276"
	"\037\024\174\002\316\200\124\024\004\166\213\222\212\360\367\257"
	"\342\213\331\152\240\067\356\124\355\200\356\333\254\142\131\115"
	"\015\321\112\103\136\134\075\063\355\232\265\212\056\055\175\200"
	"\023\055\325\020\075\200\267\274\222\215\035\105\210\112\077\232"
	"\233\006\256\317\331\144\337\213\314\143\133\252\174\165\343\142"
	"\256\232\070\120\262\266\204\117\345\273\017\202\374\104\310\024"
	"\050\310\121\110\073\045\211\353\376\077\146\017\027\254\110\154"
	"\343\305\115\164\046\004\233\341\217\055\030\255\316\106\064\340"
	"\146\156\001\036\263\043\130\115\271\176\040\050\372\073\025\112"
	"\373\350\055\072\312\311\253\064\137\037\133\323\301\030\054\372"
	"\164\072\202\255\366\043\003\335\171\071\234\067\357\266\056\050"
	"\243\073\100\275\210\016\072\261\360\075\030\214\136\111\174\231"
	"\306\260\001\212\144\351\376\366\126\202\042\071\070\114\056\035"
	"\137\067\304\274\213\331\314\213\044\145\141\361\352\235\022\347"
	"\203\353\106\116\107\303\164\251\105\321\351\370\160\106\042\255"
	"\115\201\122\360\326\232\164\045\051\200\110\176\374\162\331\065"
	"\101\141\165\135\013\051\113\124\115\343\031\127\133\346\044\152"
	"\007\007\054\100\354\211\367\223\171\331\236\123\012\036\007\325"
	"\364\015\336\231\043\263\104\132\343\266\331\244\077\035\340\220"
	"\305\311\142\117\323\356\235\274\311\170\002\177\214\257\026\305"
	"\251\153\375\366\055\235\343\356\036\124\057\201\170\016\004\144"
	"\205\056\302\062\347\172\071\057\051\252\253\002\324\100\342\041"
	"\127\103\150\373\346\326\153\166\102\310\246\303\343\363\104\174"
	"\154\266\315\120\267\052\202\173\336\053\264\023\364\346\102\321"
	"\244\163\241\362\210\077\047\353\137\106\122\043\134\245\167\353"
	"\065\000\142\313\302\270\307\124\154\070\024\253\347\343\145\044"
	"\265\135\353\255\017\336\025\104\243\164\254\110\104\355\342\036"
	"\164\004\263\146\145\254\007\103\300\342\057\306\202\354\103\034"
	"\051\127\016\166\376\042\005\065\367\160\300\010\223\300\015\345"
	"\364\242\327\141\046\202\165\143\177\247\164\025\273\356\031\356"
	"\372\125\331\017\103\165\365\060\152\335\353\163\337\113\015\360"
	"\054\326\007\226\340\216\134\311\307\117\047\046\164\123\372\165"
	"\151\024\231\155\275\061\272\103\132\010\015\323\214\376\154\357"
	"\200\002\100\360\227\343\347\246\364\274\332\130\315\173\353\275"
	"\062\107\166\026\304\347\031\023\063\320\351\222\124\362\272\101"
	"\042\046\361\316\145\002\074\216\141\164\036\213\243\236\277\143"
	"\266\047\006\200\006\060\260\365\000\243\357\072\157\001\063\002"
	"\010\043\056\167\317\316\012\167\266\033\261\336\230\353\277\004"
	"\352\012\353\374\237\160\351\164\175\030\312\024\224\065\343\334"
	"\376\335\014\320\160\316\201\000\156\131\061\260\166\016\362\036"
	"\331\132\241\325\331\152\130\026\153\042\113\041\204\325\252\265"
	"\126\005\264\375\233\334\000\006\031\371\062\122\125\146\206\043"
	"\052\301\041\026\077\257\021\051\065\066\332\110\152\252\015\207"
	"\153\020\347\250\135\266\123\274\164\023\125\276\025\262\270\234"
	"\055\066\063\253\246\236\321\136\026\372\126\221\064\072\367\014"
	"\330\050\000\164\043\135\215\205\335\313\321\314\050\356\077\021"
	"\017\246\024\037\267\340\314\054\264\144\137\070\117\324\012\015"
	"\056\106\167\257\315\365\205\015\155\303\134\153\235\076\312\202"
	"\154\263\057\250\030\131\257\206\072\144\271\266\342\205\010\061"
	"\021\032\350\150\172\016\064\214\140\116\154\245\076\042\257\024"
	"\351\140\031\363\156\335\065\311\171\063\246\216\134\234\174\370"
	"\324\272\237\270\362\145\303\200\145\054\170\273\067\207\353\363"
	"\347\026\164\341\047\324\352\066\367\017\072\340\354\106\072\150"
	"\327\275\033\352\075\263\126\343\004\063\166\202\271\313\015\043"
	"\315\140\161\245\367\207\337\333\237\203\314\070\123\057\015\137"
	"\203\101\135\352\045\305\004\377\010\133\316\264\316\126\274\060"
	"\142\172\117\046\330\376\202\275\166\260\214\146\142\156\360\072"
	"\243\231\110\251\316\116\375\371\055\376\311\041\277\255\164\140"
	"\210\357\345\132\041\250\322\326\006\167\067\325\205\134\002\052"
	"\201\120\043\261\165\137\144\137\007\155\324\044\023\112\065\374"
	"\156\031\063\020\155\251\330\267\345\274\344\054\117\317\221\162"
	"\253\120\266\100\333\220\100\044\340\222\033\257\156\204\255\342"
	"\220\326\103\365\354\362\345\040\355\067\114\310\221\102\163\323"
	"\070\144\323\006\056\041\251\154\221\216\116\334\037\021\253\312"
	"\105\222\315\044\264\152\252\204\015\247\360\033\020\137\106\202"
	"\255\370\075\006\075\154\066\215\265\325\120\002\117\154\047\174"
	"\070\010\215\014\251\051\337\007\364\357\214\346\067\133\335\012"
	"\060\212\266\036\072\025\055\077\222\145\267\304\221\106\342\022"
	"\253\166\036\144\170\361\200\213\145\034\254\006\332\055\260\367"
	"\306\235\266\011\154\323\241\315\245\077\157\337\164\150\030\122"
	"\226\043\370\360\101\162\033\153\305\324\152\342\067\323\175\362"
	"\353\134\262\341\217\036\013\246\035\151\113\107\044\234\326\056"
	"\161\267\263\121\017\066\214\015\326\143\066\161\142\241\074\157"
	"\107\347\222\305\055\135\347\047\047\300\116\231\063\202\002\322"
	"\222\125\032\207\275\271\373\333\233\040\366\036\213\300\373\035"
	"\074\177\346\126\205\123\262\356\027\114\002\005\021\204\302\200"
	"\100\067\214\100\371\232\111\061\167\373\213\110\032\271\217\071"
	"\206\336\061\245\154\006\174\173\314\370\003\006\303\206\236\203"
	"\316\117\026\304\125\320\215\156\120\354\276\217\345\111\241\262"
	"\051\176\264\021\040\326\231\053\345\126\101\370\116\224\212\140"
	"\007\254\254\173\067\210\330\140\362\055\210\105\330\022\134\155"
	"\061\173\017\162\306\203\015\132\347\117\026\053\020\373\227\121"
	"\256\262\105\073\341\114\353\173\170\225\034\272\013\036\217\326"
	"\101\014\144\333\041\006\051\253\271\340\110\030\233\123\215\126"
	"\055\336\156\056\217\101\234\331\172\156\366\004\321\066\243\346"
	"\216\033\002\114\035\035\123\233\206\235\365\302\242\277\072\037"
	"\336\374\070\331\273\265\032\272\352\301\106\346\012\341\270\114"
	"\072\156\122\376\143\321\360\254\136\026\340\150\233\216\160\122"
	"\163\266\124\175\027\366\060\243\006\324\060\265\131\173\145\205"
	"\243\303\327\246\032\057\272\050\241\237\377\047\304\324\035\275"
	"\154\071\346\202\044\037\221\060\156\260\265\172\343\351\324\263"
	"\223\047\057\152\105\161\024\060\067\242\223\150\010\300\360\231"
	"\020\341\025\005\264\243\160\065\205\160\367\207\032\310\142\144"
	"\021\257\146\257\065\307\260\223\320\314\004\350\231\177\333\102"
	"\167\265\164\027\061\023\077\307\152\075\111\271\010\061\302\301"
	"\110\062\136\124\204\070\323\313\012\352\274\251\316\066\362\173"
	"\356\324\013\137\243\352\046\015\050\160\307\060\241\211\362\351"
	"\274\121\075\100\211\020\013\224\372\310\076\311\376\060\104\354"
	"\005\117\114\250\072\163\265\142\343\174\223\204\006\205\155\302"
	"\326\253\002\140\274\016\365\267\327\063\200\325\143\304\302\151"
	"\024\017\021\117\202\306\262\145\103\105\352\111\313\127\013\242"
	"\003\016\002\300\035\367\167\364\053\370\312\217\274\214\370\321"
	"\233\011\040\036\320\322\203\023\030\156\135\344\305\151\206\311"
	"\167\211\211\225\200\001\211\254\371\123\073\265\340\064\207\174"
	"\075\250\232\016"
#define      msg2_z	19
#define      msg2	((&data[3731]))
	"\221\054\136\234\126\321\353\130\121\263\236\053\262\070\153\044"
	"\312\157\127"
#define      chk2_z	19
#define      chk2	((&data[3752]))
	"\170\122\143\263\314\237\077\352\055\127\320\272\346\233\032\125"
	"\210\355\372\036\031\347\376"
#define      shll_z	8
#define      shll	((&data[3774]))
	"\245\063\303\343\126\246\111\035\255\364"
#define      pswd_z	256
#define      pswd	((&data[3825]))
	"\264\237\322\360\125\263\044\335\057\142\205\312\160\000\351\221"
	"\224\166\020\014\310\370\013\345\130\222\212\115\232\061\313\117"
	"\321\236\100\047\121\144\004\200\306\211\102\113\043\255\340\153"
	"\317\220\013\373\126\035\050\267\114\377\366\313\330\273\227\336"
	"\213\111\150\227\047\200\261\111\320\364\224\363\241\165\136\161"
	"\006\152\154\134\207\225\024\324\225\013\237\156\306\067\114\122"
	"\200\265\352\250\066\233\361\006\220\206\371\062\374\130\243\002"
	"\303\020\137\112\245\164\037\073\177\276\251\106\366\365\230\167"
	"\252\202\037\341\036\020\347\256\227\341\341\223\072\204\226\375"
	"\224\366\110\072\152\147\165\351\046\036\057\034\024\310\223\277"
	"\112\262\240\151\303\210\030\133\151\371\356\243\175\205\240\022"
	"\173\350\114\346\120\302\320\166\341\000\223\366\310\046\265\023"
	"\331\126\175\235\336\225\370\110\217\347\353\015\154\214\037\350"
	"\165\154\317\305\056\237\074\020\240\317\006\151\366\274\174\320"
	"\022\372\155\361\217\146\071\037\115\044\054\272\261\114\243\046"
	"\270\162\353\347\022\047\367\262\366\376\033\355\272\230\275\315"
	"\222\053\277\042\221\370\101\336\035\156\231\316\272\074\364\162"
	"\257\340\132\301\007\121\164\376\120\217\353\012\050\251\330\272"
	"\324\227\335\145\217\037\104\255\215\336\113\067\212\064\311\036"
	"\252\331\053\163\322\067\130\052\311\343\167\144\025\103\264\346"
	"\342\364\015\063\131\021\264\037\233\377"
#define      xecc_z	15
#define      xecc	((&data[4113]))
	"\361\375\154\143\137\071\130\004\107\054\226\037\275\101\171"
#define      inlo_z	3
#define      inlo	((&data[4128]))
	"\333\253\342"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
